# 績效指標面板（Metrics Dashboard）

**版本**：1.0  
**最後更新**：2026-02-14  
**維護者**：Tech Lead Team

---

## 📊 目錄

1. [指標概覽](#指標概覽)
2. [開發指標](#開發指標)
3. [系統指標](#系統指標)
4. [業務指標](#業務指標)
5. [技術債務指標](#技術債務指標)
6. [團隊效能指標](#團隊效能指標)
7. [指標收集方式](#指標收集方式)
8. [Dashboard 配置](#dashboard-配置)

---

## 指標概覽

### 整體健康度評分

```
🎯 系統健康度: 85/100 (Good)

分項評分：
✅ 基礎設施:  95/100 (Excellent)
✅ 代碼品質:  80/100 (Good)
⚠️ 測試覆蓋:  70/100 (Acceptable)
✅ 可用性:    90/100 (Excellent)
⚠️ 技術債務:  65/100 (Needs Improvement)
```

### 關鍵指標（At a Glance）

| 分類 | 指標 | 當前值 | 目標 | 趨勢 | 狀態 |
|------|------|--------|------|------|------|
| 🏗️ **基礎設施** | 服務可用性 | 99.2% | 99.5% | ↗️ | ✅ |
| 🧪 **測試** | E2E 通過率 | 91.0% | 95% | ↗️ | ⚠️ |
| 🧪 **測試** | 單元測試覆蓋率 | 76% | 80% | ↗️ | ⚠️ |
| 🧪 **測試** | 前端測試覆蓋率 | 35% | 60% | ↗️ | ⚠️ |
| 💰 **技術債務** | 債務完成率 | 22% (5/23) | 80% | ↗️ | ⚠️ |
| ⚡ **性能** | API P95 延遲 | 250ms | < 300ms | → | ✅ |
| 🐛 **品質** | 生產 Bug 數 | 3/週 | < 2/週 | → | ⚠️ |
| 🚀 **部署** | 部署頻率 | 手動 | 每日 | - | ❌ |

---

## 開發指標

### 1. 測試覆蓋率趨勢

#### 後端單元測試覆蓋率

```
當前狀態: 76% (平均)

服務覆蓋率分布:
api-gateway:          85%  ████████▌
auth-service:         75%  ███████▌
user-service:         75%  ███████▌
matching-service:     75%  ███████▌
notification-service: 75%  ███████▌
messaging-service:    75%  ███████▌
content-service:      80%  ████████
subscription-service: 75%  ███████▌
payment-service:      80%  ████████
media-service:        75%  ███████▌
db-writer-service:    70%  ███████
admin-service:        60%  ██████

目標: 80% (所有服務)
```

**趨勢圖**（過去 4 週）：

```
80% |                              ○ ← 目標
    |                        ○ ● ●
75% |                  ○ ● ●
    |            ○ ● ●
70% |      ○ ● ●
    | ○ ● ●
65% |●
    +--------------------------------
     W1  W2  W3  W4  W5  W6  W7  W8
    (2月第1週)              (目標)
```

**改進計劃**：
- **Week 5-6**：提升 admin-service 至 70%
- **Week 7-8**：提升所有服務至 80%+

---

#### 前端測試覆蓋率

```
當前狀態:
- Web:   30%  ███░░░░░░░  (目標: 60%)
- Admin: 40%  ████░░░░░░  (目標: 60%)

計劃進度:
Week 1-2:  30% → 40%  ████░░░░░░
Week 3-4:  40% → 50%  █████░░░░░
Week 5-6:  50% → 60%  ██████░░░░
Week 7-8:  60% → 70%  ███████░░░
```

**關鍵元件覆蓋率**：

| 元件類型 | 覆蓋率 | 目標 | 狀態 |
|----------|--------|------|------|
| 共用元件（Button, Input, Form） | 80% | 90% | ✅ |
| 頁面元件（Login, Dashboard） | 40% | 70% | ⚠️ |
| 業務元件（Payment, Matching） | 20% | 60% | ❌ |
| Hook 測試 | 30% | 70% | ⚠️ |

---

#### E2E 測試通過率

```
當前狀態: 212/233 通過 (91.0%)

趨勢:
Week 1: 180/233 (77.3%)  ███████▊
Week 2: 200/233 (85.8%)  ████████▌
Week 3: 212/233 (91.0%)  █████████▏
Week 4: 目標 95%+        █████████▌

失敗測試分類:
- API 錯誤:     8 個  ████
- UI 不穩定:   7 個  ███▌
- 超時:        4 個  ██
- 數據問題:    2 個  █
```

**高優先級失敗測試**：
1. ❌ Payment flow - Stripe webhook timeout
2. ❌ Matching - Swipe animation flaky
3. ❌ Messaging - WebSocket reconnect

---

### 2. Bug 追踪

#### 生產 Bug 趨勢

```
當前: 3 個/週 (目標: < 2 個/週)

嚴重度分布:
Critical: 0  (✅ 0)
High:     1  (⚠️ 支付重試失敗)
Medium:   1  (⚠️ 通知延遲)
Low:      1  (⚠️ UI 樣式問題)
```

**Bug 修復速度**：

```
平均修復時間 (MTTR):
- Critical:  2 小時   ██
- High:      8 小時   ████████
- Medium:    2 天     ████████████████████
- Low:       5 天     ██████████████████████████████████████████████████

目標:
- Critical:  < 1 小時
- High:      < 4 小時
- Medium:    < 1 天
- Low:       < 3 天
```

---

### 3. 代碼提交頻率

```
提交統計 (過去 7 天):

總提交數: 42 commits
平均每天: 6 commits/day

貢獻者分布:
Backend:  18 commits  ██████████████████
Frontend: 12 commits  ████████████
DevOps:    8 commits  ████████
QA:        4 commits  ████

每日提交趨勢:
Mon: 8  ████████
Tue: 6  ██████
Wed: 7  ███████
Thu: 5  █████
Fri: 9  █████████
Sat: 4  ████
Sun: 3  ███
```

---

### 4. 代碼審查（Code Review）

```
當前狀態:

待審查 PR: 3 個
平均審查時間: 4 小時
平均審查輪次: 1.5 輪

審查品質:
- 審查覆蓋率: 100% (所有 PR 都有審查)
- 平均評論數: 8 條/PR
- 阻擋合併:   15% (品質把關)

目標:
- 平均審查時間: < 2 小時
- 阻擋率: 10-20% (保持品質)
```

---

## 系統指標

### 1. 可用性（Availability）

#### 服務可用性

```
當前狀態: 99.2% (過去 30 天)

目標: 99.9% (three nines)
差距: -0.7%

停機時間統計:
- 總停機時間: 5.8 小時/月
- 目標停機時間: < 43 分鐘/月
- 需要改進: -5 小時

主要停機原因:
1. PostgreSQL 單點故障 (2 小時) ← P0-002 修復中
2. Redis 重啟 (1.5 小時) ← P0-003 修復中
3. 部署中斷 (1 小時) ← P1-004 改進中
4. 未知原因 (1.3 小時) ← 需要監控系統
```

**可用性趨勢**（過去 12 週）：

```
100%|
    |
99% |    ●     ●   ●   ●     ● ← 當前
    |  ●   ● ●   ●   ●   ● ●
98% |●                         
    +---------------------------
     W1 W2 W3 W4 W5 W6 W7 W8 W9 W10 W11 W12

停機事件:
W1:  PostgreSQL 故障 (2h)
W8:  Redis OOM (1.5h)
W11: 部署失敗 (1h)
```

---

#### 服務依賴可用性

| 依賴服務 | 可用性 | SLA | 狀態 |
|----------|--------|-----|------|
| PostgreSQL | 98.5% | 99.9% | ⚠️ 需 HA |
| Redis | 99.0% | 99.9% | ⚠️ 需 Sentinel |
| Kafka | 99.8% | 99.9% | ✅ |
| Stripe API | 99.99% | 99.99% | ✅ |
| AWS S3 | 99.99% | 99.99% | ✅ |

---

### 2. 平均故障恢復時間（MTTR）

```
當前 MTTR: 2.5 小時
目標 MTTR: < 1 小時

改進計劃:
1. 監控系統上線 → 減少發現時間 (-1 小時) ← P0-004
2. 自動告警系統 → 減少響應時間 (-30 分鐘) ← P0-004
3. 高可用架構 → 減少修復時間 (-30 分鐘) ← P0-002, P0-003
4. Runbook 完善 → 減少定位時間 (-30 分鐘) ← 進行中

預期改進後 MTTR: 30 分鐘 ✅
```

**MTTR 分解**：

```
故障發現時間:    60 分鐘  ████████████████████████
響應時間:        30 分鐘  ████████████
定位時間:        40 分鐘  ████████████████
修復時間:        20 分鐘  ████████

改進空間: 發現時間（需監控系統）
```

---

### 3. API 性能指標

#### 響應時間（Latency）

```
當前狀態 (P95):

API Gateway:         50ms   █████
Auth Service:       120ms   ████████████
User Service:       150ms   ███████████████
Matching Service:   200ms   ████████████████████
Content Service:    250ms   █████████████████████████
Payment Service:    180ms   ██████████████████
Subscription:       160ms   ████████████████

目標: < 300ms (P95)
狀態: ✅ 所有服務達標

P99 延遲:
最慢服務: Content Service (450ms)
目標: < 500ms
狀態: ✅ 達標
```

**延遲趨勢**（過去 4 週）：

```
500ms|
     |
400ms|          ○
     |       ○
300ms|    ○           ○ ← 目標
     | ○           ●
200ms|          ●
     |       ●
100ms|    ●
     |_________________________
      W1  W2  W3  W4  W5  W6

改進措施:
W2: 添加 Redis 快取
W3: 優化資料庫查詢
W5: 計劃 PostgreSQL 讀寫分離
```

---

#### 吞吐量（Throughput）

```
當前 QPS (Queries Per Second):

總 QPS: 120 req/s

服務分布:
Auth:         15 req/s  ███
User:         25 req/s  █████
Matching:     20 req/s  ████
Content:      30 req/s  ██████
Messaging:    15 req/s  ███
Notification: 10 req/s  ██
Payment:       5 req/s  █

峰值 QPS: 180 req/s (週五晚上 8-10pm)

容量規劃:
當前容量: 200 req/s (平均)
峰值負載: 180 req/s (90% 使用率)
安全閾值: 80% (160 req/s)

⚠️ 警告: 接近容量上限，需考慮擴展
```

---

#### 錯誤率（Error Rate）

```
當前錯誤率: 0.8%

目標: < 1%
狀態: ✅ 達標

錯誤分類:
4xx (客戶端錯誤): 0.5%  (主要是 401 Unauthorized)
5xx (伺服器錯誤): 0.3%  (主要是 503 Service Unavailable)

高錯誤率端點:
1. POST /api/payment/tip        (2.5% - Stripe 超時)
2. POST /api/matching/swipe     (1.2% - 資料庫鎖定)
3. GET  /api/content/:id/unlock (1.0% - 冪等檢查)
```

---

### 4. 資源使用率

#### 計算資源

```
CPU 使用率 (平均):
PostgreSQL:  15%  ███
Redis:        5%  █
Kafka:       10%  ██
API Services: 20%  ████

記憶體使用率 (平均):
PostgreSQL:  40%  ████████
Redis:       25%  █████
Kafka:       30%  ██████
API Services: 35%  ███████

狀態: ✅ 資源使用率健康 (< 80%)
```

#### 存儲資源

```
資料庫大小:
PostgreSQL: 8.5 GB (總容量 50 GB, 17% 使用)
Redis:      2.1 GB (總容量 8 GB, 26% 使用)

資料增長率:
PostgreSQL: +500 MB/週
Redis:      +50 MB/週

容量預測:
PostgreSQL 將於 18 個月後達 50% (25 GB)
Redis 將於 6 個月後達 50% (4 GB)

狀態: ✅ 容量充足
```

---

## 業務指標

### 1. 用戶增長

```
當前狀態:
總註冊用戶: 12,500 (↗ +15% vs 上月)
月活躍用戶: 8,200 (66% MAU/總用戶)
日活躍用戶: 2,500 (20% DAU/總用戶)

增長趨勢 (過去 6 個月):
Jan: 8,500  ████████▌
Feb: 9,800  █████████▊
Mar: 10,500 ██████████▌
Apr: 11,200 ███████████▏
May: 11,800 ███████████▊
Jun: 12,500 ████████████▌ ← 當前

月增長率: +5.9% (目標: > 5%)
```

---

### 2. 配對成功率

```
當前配對成功率: 18% (目標: > 20%)

配對漏斗:
註冊用戶:     12,500  ████████████████████████████████
完成檔案:     10,000  ████████████████████████ (80%)
開始滑卡:      8,500  █████████████████████ (68%)
發出 Like:     7,200  ██████████████████ (58%)
獲得配對:      2,250  █████▌ (18%) ← 改進空間

改進計劃:
1. 優化推薦算法 (預期 +3%)
2. 改善用戶檔案品質 (預期 +2%)
```

---

### 3. 訂閱數量

```
當前訂閱:
總訂閱數: 850 (↗ +20% vs 上月)
創作者數: 120 (7 位活躍)

訂閱分布:
1 個月方案:  500 (59%)  ███████████▊
3 個月方案:  250 (29%)  █████▊
6 個月方案:  100 (12%)  ██▍

訂閱續訂率: 75% (目標: > 80%)
流失率: 25% (需改進)

頂級創作者:
1. Creator A: 250 訂閱
2. Creator B: 180 訂閱
3. Creator C: 150 訂閱
```

---

### 4. 支付成功率

```
當前支付成功率: 92% (目標: > 95%)

支付失敗原因:
卡片被拒: 4%  ████
餘額不足: 2%  ██
技術錯誤: 1%  █
其他:     1%  █

支付方式分布:
信用卡:  75%  ███████▌
簽帳卡:  20%  ██
其他:     5%  ▌

平均交易金額:
打賞:     $15
PPV:      $10
訂閱:     $30/月
```

---

### 5. 收入指標

```
當前月收入（MRR）: $32,500

收入來源:
訂閱:      $25,500 (78%)  ███████▊
打賞:      $4,500  (14%)  █▍
PPV:       $2,500  (8%)   ▊

月同比增長: +25%

收入趨勢 (過去 6 個月):
Jan: $20,000  ████████
Feb: $22,000  ████████▊
Mar: $24,500  █████████▊
Apr: $27,000  ██████████▊
May: $29,500  ███████████▊
Jun: $32,500  █████████████ ← 當前
```

---

## 技術債務指標

### 1. 技術債務完成率

```
當前進度: 5/23 完成 (22%)

目標: Q1 完成 80% P0 項目 (4/5)

分類進度:
P0 (Critical): 0/5  (0%)   [░░░░░░░░░░] ← 本週焦點
P1 (High):     0/8  (0%)   [░░░░░░░░░░]
P2 (Medium):   0/6  (0%)   [░░░░░░░░░░]
P3 (Low):      0/4  (0%)   [░░░░░░░░░░]

已完成 (5):
✅ 錯誤處理標準化
✅ Redis ↔ DB 一致性
✅ Kafka DLQ
✅ OAuth 第三方登入
✅ Stripe Connect 分潤
```

---

### 2. 技術債務估算成本

```
總估算工時: 760 小時 (95 天)

已投入: 160 小時 (21%)
剩餘: 600 小時 (79%)

預計完成日期:
- P0: 2026-03-15 (3 週後)
- P1: 2026-04-30 (10 週後)
- 全部: 2026-06-30 (4.5 個月後)

實際進度 vs 計劃:
計劃進度: 30% (預期)
實際進度: 22% (當前)
偏差: -8% (需加速)
```

---

### 3. 技術債務 ROI

```
投資回報率評估:

高 ROI 項目 (優先):
1. P0-004 (監控): 投入 40h, 收益 MTTR↓70%  ⭐⭐⭐⭐⭐
2. P0-001 (追蹤): 投入 40h, 收益 調試↑60%  ⭐⭐⭐⭐⭐
3. P0-002 (PG HA): 投入 40h, 收益 可用性↑  ⭐⭐⭐⭐⭐
4. P0-003 (Redis): 投入 24h, 收益 可用性↑  ⭐⭐⭐⭐⭐
5. P1-004 (CI/CD): 投入 40h, 收益 部署↓80% ⭐⭐⭐⭐

中 ROI 項目:
6. P1-001 (日誌): 投入 56h, 收益 調試↑40%  ⭐⭐⭐⭐
7. P1-002 (網格): 投入 80h, 收益 流量管理  ⭐⭐⭐

低 ROI 項目:
8. P2-001 (重構): 投入 40h, 收益 維護↓20%  ⭐⭐
```

---

## 團隊效能指標

### 1. Sprint 完成率

```
過去 4 個 Sprint:

Sprint W1: 80% (4/5 完成)  ████████
Sprint W2: 90% (9/10 完成) █████████
Sprint W3: ___% (進行中)   [░░░░░░░░░░]
Sprint W4: ___% (計劃中)   [░░░░░░░░░░]

平均完成率: 85%
目標: > 80%
狀態: ✅ 達標
```

---

### 2. 速率（Velocity）

```
Story Points 完成速率:

W1: 25 SP  █████████████
W2: 30 SP  ███████████████
W3: ___ SP (進行中)

平均速率: 27.5 SP/週
趨勢: ↗️ 提升中

團隊容量:
總工時: 160 小時/週 (4 人 × 40 小時)
實際開發: 120 小時/週 (75%)
會議/其他: 40 小時/週 (25%)
```

---

### 3. 阻礙和風險

```
當前阻礙: 2 個

🔴 高影響:
1. DevOps 資源緊張（4 任務並行）
   - 影響: P0 項目可能延期
   - 應對: 調整優先級

🟡 中影響:
2. 測試環境偶爾不穩定
   - 影響: E2E 測試通過率
   - 應對: 加強監控

已解決: 3 個
本週新增: 2 個
解決速度: 1.5 個/週
```

---

## 指標收集方式

### 自動化收集

```yaml
# 監控系統
prometheus:
  - API 響應時間
  - 錯誤率
  - QPS
  - 資源使用率

# CI/CD
github_actions:
  - 測試通過率
  - 代碼覆蓋率
  - 構建時間

# 應用日誌
elk_stack:
  - 錯誤日誌
  - 性能日誌
  - 業務日誌
```

### 手動收集

```
每週統計:
- Sprint 完成率（Tech Lead）
- 技術債務進度（Tech Lead）
- 團隊阻礙（Daily Standup）

每月統計:
- 業務指標（Product Owner）
- 用戶增長（Analytics）
- 收入指標（Finance）
```

---

## Dashboard 配置

### Grafana Dashboard

#### 1. 系統健康 Dashboard

**面板**：
- 服務可用性（過去 30 天）
- API 響應時間（P50/P95/P99）
- 錯誤率趨勢
- 資源使用率（CPU/記憶體）

**告警**：
- 可用性 < 99%
- P95 延遲 > 500ms
- 錯誤率 > 1%
- CPU > 80%

---

#### 2. 業務指標 Dashboard

**面板**：
- 每日活躍用戶（DAU）
- 每月活躍用戶（MAU）
- 訂閱數量趨勢
- 支付成功率
- 收入趨勢（MRR）

---

#### 3. 開發指標 Dashboard

**面板**：
- 測試覆蓋率趨勢
- E2E 測試通過率
- Bug 數量和嚴重度
- 代碼提交頻率

---

### 週報 Dashboard

**文檔**：`docs/SPRINT_REPORT_YYYY_MM_WW.md`

**內容**：
- Sprint 目標達成率
- 完成項目列表
- 未完成項目和原因
- 下週計劃
- 風險和阻礙

---

## 指標改進計劃

### 短期（1-2 週）

- [ ] 部署 Prometheus + Grafana（P0-004）
- [ ] 配置系統健康 Dashboard
- [ ] 配置自動告警

### 中期（1-2 個月）

- [ ] 整合 ELK Stack（P1-001）
- [ ] 配置業務指標收集
- [ ] 自動化週報生成

### 長期（3-6 個月）

- [ ] 機器學習異常檢測
- [ ] 預測性告警
- [ ] 自動化容量規劃

---

## 附錄

### A. 指標定義

**可用性（Availability）**：
```
可用性 = (總時間 - 停機時間) / 總時間 × 100%
```

**MTTR（Mean Time To Recovery）**：
```
MTTR = 總恢復時間 / 故障次數
```

**P95 延遲**：
95% 的請求響應時間低於此值。

**QPS（Queries Per Second）**：
每秒處理的請求數量。

---

### B. 基準值和目標

| 指標 | 當前 | 良好 | 優秀 |
|------|------|------|------|
| 可用性 | 99.2% | 99.5% | 99.9% |
| MTTR | 2.5h | 1h | 30min |
| API P95 | 250ms | 300ms | 200ms |
| 錯誤率 | 0.8% | 1% | 0.5% |
| 測試覆蓋率 | 76% | 80% | 90% |

---

**文檔結束**

*衡量帶來改進。持續追踪指標，持續優化系統！* 📊
