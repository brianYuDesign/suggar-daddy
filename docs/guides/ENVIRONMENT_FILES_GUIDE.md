# ç’°å¢ƒè®Šæ•¸æ–‡ä»¶æ•´ç†æŒ‡å—

æœ¬æ–‡æª”èªªæ˜å°ˆæ¡ˆä¸­å„å€‹ç’°å¢ƒè®Šæ•¸æ–‡ä»¶çš„ç”¨é€”ï¼Œä»¥åŠå¦‚ä½•æ­£ç¢ºä½¿ç”¨å®ƒå€‘ã€‚

## ğŸ“ ç•¶å‰ç’°å¢ƒæ–‡ä»¶

å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹æœ‰ä»¥ä¸‹ç’°å¢ƒæ–‡ä»¶ï¼š

| æ–‡ä»¶å | æ‡‰è©²æäº¤ï¼Ÿ | ç”¨é€” | å„ªå…ˆç´š |
|--------|-----------|------|-------|
| `.env.example` | âœ… æ˜¯ | ç’°å¢ƒè®Šæ•¸ç¯„æœ¬ï¼ŒåŒ…å«æ‰€æœ‰å¯ç”¨è®Šæ•¸ | - |
| `.env` | âŒ å¦ | æœ¬åœ°é–‹ç™¼é è¨­é…ç½® | 3 |
| `.env.development` | âš ï¸ å¯é¸ | é–‹ç™¼ç’°å¢ƒé…ç½® | 2 |
| `.env.staging` | âš ï¸ å¯é¸ | æ¸¬è©¦ç’°å¢ƒé…ç½® | - |
| `.env.production` | âŒ å¦ | ç”Ÿç”¢ç’°å¢ƒé…ç½®ï¼ˆæ•æ„Ÿï¼‰ | - |
| `.env.docker` | âœ… æ˜¯ | Docker Compose ä½¿ç”¨ | - |
| `.env.local` | âŒ å¦ | æœ¬åœ°è¦†è“‹é…ç½®ï¼ˆæœ€é«˜å„ªå…ˆç´šï¼‰ | 1 |

## ğŸ”„ è¼‰å…¥é †åº

ç•¶ `NODE_ENV=development` æ™‚ï¼š

```
.env â†’ .env.development â†’ .env.local
  â†“          â†“                â†“
åŸºç¤é…ç½®   ç’°å¢ƒé…ç½®        æœ¬åœ°è¦†è“‹ï¼ˆå„ªå…ˆç´šæœ€é«˜ï¼‰
```

## ğŸ“‹ ä½¿ç”¨å»ºè­°

### é–‹ç™¼è€…ï¼ˆæœ¬åœ°é–‹ç™¼ï¼‰

1. **åˆæ¬¡è¨­ç½®**
   ```bash
   # è¤‡è£½ç¯„æœ¬æ–‡ä»¶
   cp .env.example .env
   
   # ä¿®æ”¹å¿…è¦çš„è®Šæ•¸
   vi .env
   ```

2. **å€‹äººé…ç½®è¦†è“‹**
   ```bash
   # å¦‚æœéœ€è¦è¦†è“‹æŸäº›é…ç½®ï¼Œå‰µå»º .env.local
   echo "LOG_LEVEL=debug" > .env.local
   echo "PORT=3001" >> .env.local
   ```

3. **ä¸è¦ä¿®æ”¹ .env.example**  
   `.env.example` æ˜¯åœ˜éšŠå…±äº«çš„ç¯„æœ¬ï¼Œåªèƒ½åœ¨æ–°å¢è®Šæ•¸æ™‚ä¿®æ”¹ã€‚

### åœ˜éšŠå”ä½œ

- âœ… **æ‡‰è©²æäº¤**: `.env.example`, `.env.docker`
- âŒ **ä¸æ‡‰æäº¤**: `.env`, `.env.local`, `.env.production`
- âš ï¸ **è¦–æƒ…æ³**: `.env.development`, `.env.staging` ï¼ˆå¦‚æœä¸åŒ…å«æ•æ„Ÿè³‡æ–™å¯ä»¥æäº¤ï¼‰

### CI/CD ç’°å¢ƒ

- ä½¿ç”¨ç’°å¢ƒè®Šæ•¸æ³¨å…¥æˆ– Secrets ç®¡ç†å·¥å…·
- **ä¸è¦**å°‡ç”Ÿç”¢ç’°å¢ƒçš„ `.env.production` æäº¤åˆ° Git

## ğŸ”’ å®‰å…¨æª¢æŸ¥æ¸…å–®

- [ ] `.env` å·²åŠ å…¥ `.gitignore`
- [ ] `.env.local` å·²åŠ å…¥ `.gitignore`  
- [ ] `.env.production` å·²åŠ å…¥ `.gitignore`
- [ ] `.env.example` ä¸­æ²’æœ‰çœŸå¯¦çš„å¯†é‘°
- [ ] æ•æ„Ÿè³‡æ–™ä½¿ç”¨ Docker Secretsï¼ˆç”Ÿç”¢ç’°å¢ƒï¼‰
- [ ] æ–‡ä»¶æ¬Šé™è¨­ç‚º `600`ï¼ˆåªæœ‰æ“æœ‰è€…å¯è®€å¯«ï¼‰

```bash
# è¨­ç½®æ­£ç¢ºçš„æ–‡ä»¶æ¬Šé™
chmod 600 .env .env.local .env.production
```

## ğŸ§¹ æ¸…ç†å»ºè­°

### å¯ä»¥åˆªé™¤çš„æ–‡ä»¶

å¦‚æœä½ çš„å°ˆæ¡ˆä¸­æœ‰ä»¥ä¸‹æ–‡ä»¶ï¼Œå¯ä»¥è€ƒæ…®åˆªé™¤æˆ–åˆä½µï¼š

- `.env.test` â†’ ä½¿ç”¨ `.env.development` æˆ–ç¨ç«‹æ¸¬è©¦é…ç½®
- `.env.local.backup` â†’ ä¸éœ€è¦çš„å‚™ä»½æ–‡ä»¶
- å…¶ä»– `.env.*` è‡ªå®šç¾©æ–‡ä»¶ â†’ çµ±ä¸€ä½¿ç”¨æ¨™æº–å‘½å

### æ¨™æº–åŒ–æµç¨‹

```bash
# 1. å‚™ä»½ç¾æœ‰é…ç½®ï¼ˆå¦‚éœ€è¦ï¼‰
mkdir -p backups/env-backup
cp .env* backups/env-backup/

# 2. åªä¿ç•™å¿…è¦çš„æ–‡ä»¶
.env.example      # ç¯„æœ¬ï¼ˆæäº¤ï¼‰
.env              # æœ¬åœ°é–‹ç™¼ï¼ˆä¸æäº¤ï¼‰
.env.local        # æœ¬åœ°è¦†è“‹ï¼ˆä¸æäº¤ï¼‰
.env.docker       # Docker ä½¿ç”¨ï¼ˆæäº¤ï¼‰
.env.production   # ç”Ÿç”¢ç’°å¢ƒï¼ˆä¸æäº¤ï¼Œä½¿ç”¨ secrets ç®¡ç†ï¼‰
```

## ğŸ“š ç›¸é—œæ–‡æª”

- [ç’°å¢ƒè®Šæ•¸å®Œæ•´èªªæ˜](../technical/environment-variables.md)
- [Docker Secrets ç®¡ç†](../devops/secrets-management.md)
- [é–‹ç™¼æŒ‡å—](../technical/development.md)

## â“ å¸¸è¦‹å•é¡Œ

### Q: æˆ‘æ‡‰è©²åœ¨å“ªå€‹æ–‡ä»¶ä¸­ä¿®æ”¹é…ç½®ï¼Ÿ
**A**: 
- æœ¬åœ°é–‹ç™¼ï¼šä¿®æ”¹ `.env` æˆ–å‰µå»º `.env.local`
- åœ˜éšŠå…±äº«é è¨­å€¼ï¼šæ›´æ–° `.env.example`
- Docker éƒ¨ç½²ï¼šä¿®æ”¹ `.env.docker`

### Q: ç‚ºä»€éº¼æœ‰é€™éº¼å¤šç’°å¢ƒæ–‡ä»¶ï¼Ÿ
**A**: ä¸åŒç’°å¢ƒï¼ˆé–‹ç™¼ã€æ¸¬è©¦ã€ç”Ÿç”¢ï¼‰æœ‰ä¸åŒçš„é…ç½®éœ€æ±‚ã€‚ä½¿ç”¨å¤šå€‹æ–‡ä»¶å¯ä»¥ï¼š
- é¿å…é…ç½®è¡çª
- æé«˜å®‰å…¨æ€§
- ä¾¿æ–¼ç’°å¢ƒåˆ‡æ›

### Q: `.env.local` ä»€éº¼æ™‚å€™ä½¿ç”¨ï¼Ÿ
**A**: ç•¶ä½ éœ€è¦åœ¨**ä¸ä¿®æ”¹ `.env`** çš„æƒ…æ³ä¸‹è¦†è“‹æŸäº›é…ç½®æ™‚ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼š
- å€‹äººåå¥½çš„ `LOG_LEVEL`
- æœ¬åœ°æ¸¬è©¦ç”¨çš„ç«¯å£
- å€‹äººé–‹ç™¼ç”¨çš„è³‡æ–™åº«é€£æ¥

### Q: å¦‚ä½•é©—è­‰ç’°å¢ƒè®Šæ•¸æ˜¯å¦æ­£ç¢ºè¼‰å…¥ï¼Ÿ
**A**:
```bash
# æ–¹æ³• 1: å•Ÿå‹•æœå‹™ä¸¦æŸ¥çœ‹æ—¥èªŒ
npm run dev

# æ–¹æ³• 2: ä½¿ç”¨ Node.js æª¢æŸ¥
node -e "require('dotenv').config(); console.log(process.env.NODE_ENV)"
```

### Q: ç”Ÿç”¢ç’°å¢ƒå¦‚ä½•ç®¡ç†æ•æ„Ÿè³‡æ–™ï¼Ÿ
**A**: ä½¿ç”¨ Docker Secrets æˆ–é›²ç«¯ Secrets ç®¡ç†æœå‹™ï¼š
```bash
# Docker Secrets
./scripts/setup-secrets.sh --production

# Kubernetes Secrets
kubectl create secret generic app-secrets --from-file=secrets/
```

## ğŸ“ æ›´æ–°æ—¥èªŒ

- **2026-02-17**: å‰µå»ºç’°å¢ƒè®Šæ•¸æ•´ç†æŒ‡å—
- ç¢ºèªå„ç’°å¢ƒæ–‡ä»¶çš„ç”¨é€”å’Œæäº¤ç­–ç•¥
