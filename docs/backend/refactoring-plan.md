# å¾Œç«¯é‡æ§‹è¨ˆåŠƒ

> **åˆ¶å®šæ—¥æœŸ**: 2024-02-17  
> **è¨ˆåŠƒæœŸé–“**: 4 é€±  
> **è² è²¬åœ˜éšŠ**: Backend Development Team  
> **åŸºæ–¼**: [ä»£ç¢¼é‡è¤‡åˆ†æå ±å‘Š](./code-duplication.md)

## ğŸ“‹ åŸ·è¡Œæ‘˜è¦

æœ¬è¨ˆåŠƒåŸºæ–¼é‡è¤‡ä»£ç¢¼åˆ†æå ±å‘Šï¼Œåˆ¶å®šäº†ç³»çµ±åŒ–çš„é‡æ§‹æ–¹æ¡ˆï¼Œç›®æ¨™æ˜¯åœ¨ **4 é€±å…§æ¸›å°‘ 80% çš„ä»£ç¢¼é‡è¤‡**ï¼Œæå‡ä»£ç¢¼è³ªé‡å’Œé–‹ç™¼æ•ˆç‡ã€‚

### é‡æ§‹ç›®æ¨™

âœ… **ä»£ç¢¼è³ªé‡**
- æ¸›å°‘ 506+ è¡Œé‡è¤‡ä»£ç¢¼è‡³ ~100 è¡Œï¼ˆ-80%ï¼‰
- æå‡ä»£ç¢¼å¯ç¶­è­·æ€§å’Œå¯è®€æ€§
- çµ±ä¸€ç·¨ç¢¼è¦ç¯„å’Œæœ€ä½³å¯¦è¸

âœ… **é–‹ç™¼æ•ˆç‡**
- æ–°æœå‹™å‰µå»ºæ™‚é–“å¾ 4 å°æ™‚ç¸®çŸ­è‡³ 1 å°æ™‚ï¼ˆ-75%ï¼‰
- Bug ä¿®å¾©æ™‚é–“å¾ 2 å°æ™‚ç¸®çŸ­è‡³ 0.5 å°æ™‚ï¼ˆ-75%ï¼‰
- ä»£ç¢¼å¯©æŸ¥æ™‚é–“å¾ 1 å°æ™‚ç¸®çŸ­è‡³ 0.5 å°æ™‚ï¼ˆ-50%ï¼‰

âœ… **æŠ€è¡“å‚µå‹™**
- æ¸…ç†æŠ€è¡“å‚µå‹™
- å»ºç«‹å…±äº«åº«ç”Ÿæ…‹ç³»çµ±
- æå‡æ¸¬è©¦è¦†è“‹ç‡è‡³ 80%+

---

## ğŸ“Š é‡æ§‹å„ªå…ˆç´šçŸ©é™£

| å„ªå…ˆç´š | é …ç›® | å½±éŸ¿ç¯„åœ | è¤‡é›œåº¦ | é¢¨éšª | å·¥æ™‚ |
|--------|------|---------|--------|------|------|
| ğŸ”´ P0 | æ—¥èªŒåˆå§‹åŒ– | 50+ å€‹é¡ | ä½ | ä½ | 2h |
| ğŸ”´ P0 | ID ç”Ÿæˆå‡½æ•¸ | 4 å€‹æœå‹™ | ä½ | ä½ | 1h |
| ğŸ”´ P0 | æœå‹™å®¢æˆ¶ç«¯ | 3 å€‹æœå‹™ | ä¸­ | ä¸­ | 3h |
| ğŸŸ¡ P1 | æ¨¡çµ„é…ç½® | 13 å€‹æœå‹™ | ä¸­ | ä¸­ | 2h |
| ğŸŸ¡ P1 | äº‹ä»¶ç”Ÿç”¢è€… | 3 å€‹æœå‹™ | ä¸­ | ä½ | 2h |
| ğŸŸ¡ P1 | Redis éµç®¡ç† | 6+ å€‹æœå‹™ | ä½ | ä½ | 2h |
| ğŸŸ¡ P1 | éŒ¯èª¤è™•ç† | æ‰€æœ‰æœå‹™ | ä¸­ | ä½ | 3h |
| ğŸŸ¢ P2 | DTO çµ±ä¸€ | å¾…ç¢ºå®š | ä½ | ä½ | 4h |

**ç¸½å·¥æ™‚**: 19 å°æ™‚

---

## ğŸ—“ï¸ 4 é€±é‡æ§‹æ™‚é–“è¡¨

### Week 1: åŸºç¤å·¥å…·é‡æ§‹ï¼ˆP0ï¼‰

#### Day 1-2: æ—¥èªŒç³»çµ±æ¨™æº–åŒ–
**ç›®æ¨™**: çµ±ä¸€æ—¥èªŒåˆå§‹åŒ–æ–¹å¼ï¼Œæ¸›å°‘ 50 è¡Œé‡è¤‡ä»£ç¢¼

**Task 1.1: å‰µå»ºæ—¥èªŒè£é£¾å™¨**ï¼ˆ2hï¼‰
```typescript
// libs/common/src/decorators/inject-logger.decorator.ts
export function InjectLogger(): PropertyDecorator {
  return (target: any, propertyKey: string | symbol) => {
    const logger = new Logger(target.constructor.name);
    Object.defineProperty(target, propertyKey, {
      value: logger,
      writable: false,
    });
  };
}
```

**æ­¥é©Ÿ**:
1. âœ… åœ¨ `libs/common/src/decorators/` å‰µå»ºè£é£¾å™¨
2. âœ… ç·¨å¯«å–®å…ƒæ¸¬è©¦
3. âœ… æ›´æ–° 5 å€‹æ ¸å¿ƒæœå‹™ä½œç‚ºè©¦é»ï¼š
   - `user-service`
   - `content-service`
   - `payment-service`
   - `subscription-service`
   - `messaging-service`
4. âœ… é©—è­‰æ—¥èªŒåŠŸèƒ½æ­£å¸¸
5. âœ… æ–‡æª”æ›´æ–°

**é©—æ”¶æ¨™æº–**:
- [ ] è£é£¾å™¨æ¸¬è©¦è¦†è“‹ç‡ 100%
- [ ] 5 å€‹è©¦é»æœå‹™æˆåŠŸé·ç§»
- [ ] æ—¥èªŒæ ¼å¼çµ±ä¸€
- [ ] ç„¡åŠŸèƒ½å›æ­¸

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Dev #1  
**é ä¼°å·¥æ™‚**: 2 å°æ™‚

---

**Task 1.2: ID ç”Ÿæˆå·¥å…·é¡**ï¼ˆ1hï¼‰
```typescript
// libs/common/src/utils/id-generator.ts
export class IdGenerator {
  static generate(prefix: string): string {
    return `${prefix}-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;
  }
  
  static generateByType(type: 'post' | 'tx' | 'sub'): string {
    return this.generate(type);
  }
}
```

**æ­¥é©Ÿ**:
1. âœ… å‰µå»º `IdGenerator` é¡
2. âœ… ç·¨å¯«å®Œæ•´æ¸¬è©¦ï¼ˆå”¯ä¸€æ€§ã€æ ¼å¼ã€æ™‚é–“æˆ³æå–ï¼‰
3. âœ… æ›´æ–° 4 å€‹æœå‹™ï¼š
   - `content-service/post.service.ts`
   - `payment-service/transaction.service.ts`
   - `payment-service/wallet.service.ts`
   - `subscription-service/subscription.service.ts`
4. âœ… é©—è­‰ ID ç”Ÿæˆæ­£ç¢º

**é©—æ”¶æ¨™æº–**:
- [ ] æ¸¬è©¦è¦†è“‹ç‡ 100%
- [ ] ç”Ÿæˆ 1000 å€‹ ID ç„¡é‡è¤‡
- [ ] 4 å€‹æœå‹™æˆåŠŸé·ç§»
- [ ] æ€§èƒ½ç„¡æ˜é¡¯ä¸‹é™

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Dev #2  
**é ä¼°å·¥æ™‚**: 1 å°æ™‚

---

#### Day 3-5: æœå‹™å®¢æˆ¶ç«¯é‡æ§‹

**Task 1.3: å‰µå»ºåŸºç¤æœå‹™å®¢æˆ¶ç«¯**ï¼ˆ3hï¼‰

**æ­¥é©Ÿ**:

**Phase 1: å‰µå»ºåŸºç¤é¡**ï¼ˆ1hï¼‰
```typescript
// libs/service-clients/src/base-service-client.ts
export abstract class BaseServiceClient {
  protected readonly client: AxiosInstance;
  protected abstract readonly logger: Logger;

  constructor(baseURL: string, config: ConfigService) {
    this.client = axios.create({
      baseURL: baseURL.replace(/\/$/, ''),
      timeout: 5000,
      headers: { 'Content-Type': 'application/json' },
    });
    
    this.setupInterceptors();
  }

  protected async get<T>(url: string, config?: AxiosRequestConfig): Promise<T> {
    const response = await this.client.get<T>(url, config);
    return response.data;
  }

  // ... å…¶ä»–æ–¹æ³•
}
```

1. âœ… å‰µå»º `BaseServiceClient`
2. âœ… æ·»åŠ è«‹æ±‚/éŸ¿æ‡‰æ””æˆªå™¨
3. âœ… å¯¦ç¾ get/post/put/delete æ–¹æ³•
4. âœ… æ·»åŠ éŒ¯èª¤è™•ç†
5. âœ… ç·¨å¯«æ¸¬è©¦

**Phase 2: æå– SubscriptionServiceClient**ï¼ˆ1hï¼‰
```typescript
// libs/service-clients/src/subscription-service.client.ts
@Injectable()
export class SubscriptionServiceClient extends BaseServiceClient {
  protected readonly logger = new Logger(SubscriptionServiceClient.name);

  constructor(config: ConfigService) {
    super(config.get('SUBSCRIPTION_SERVICE_URL'), config);
  }

  async hasActiveSubscription(params: {
    subscriberId: string;
    creatorId: string;
    tierId?: string;
  }): Promise<boolean> {
    const queryParams = new URLSearchParams({
      subscriberId: params.subscriberId,
      creatorId: params.creatorId,
    });
    if (params.tierId) queryParams.set('tierId', params.tierId);

    try {
      const response = await this.get<{ hasAccess: boolean }>(
        `/api/subscriptions/check`,
        { params: queryParams }
      );
      return response.hasAccess === true;
    } catch (error) {
      this.logger.warn('Subscription check failed', error);
      return false;
    }
  }
}
```

1. âœ… å¾ `messaging-service` æå–
2. âœ… å¾ `content-service` ç§»é™¤é‡è¤‡ä»£ç¢¼
3. âœ… æ›´æ–°å°å…¥è·¯å¾‘
4. âœ… æ¸¬è©¦é›†æˆ

**Phase 3: å‰µå»ºå…¶ä»–å®¢æˆ¶ç«¯**ï¼ˆ1hï¼‰
1. âœ… å‰µå»º `UserServiceClient`
2. âœ… å‰µå»º `PaymentServiceClient`
3. âœ… å‰µå»º `ServiceClientsModule`
4. âœ… æ›´æ–°æ‰€æœ‰ä½¿ç”¨è™•

**é©—æ”¶æ¨™æº–**:
- [ ] åŸºç¤é¡æ¸¬è©¦è¦†è“‹ç‡ 90%+
- [ ] 3 å€‹æœå‹™å®¢æˆ¶ç«¯å®Œæˆ
- [ ] æ‰€æœ‰ä½¿ç”¨è™•å·²æ›´æ–°
- [ ] é›†æˆæ¸¬è©¦é€šé
- [ ] API èª¿ç”¨æ­£å¸¸

**é¢¨éšª**: ä¸­ï¼ˆéœ€è¦æ›´æ–°å¤šå€‹æœå‹™ï¼‰  
**è² è²¬äºº**: Backend Dev #1 + #2  
**é ä¼°å·¥æ™‚**: 3 å°æ™‚

---

### Week 2: æ¨¡çµ„å’Œæ¶æ§‹é‡æ§‹ï¼ˆP1ï¼‰

#### Day 1-2: æ¨¡çµ„é…ç½®æ¨™æº–åŒ–

**Task 2.1: å‰µå»ºåŸºç¤å¾®æœå‹™æ¨¡çµ„**ï¼ˆ2hï¼‰

**æ­¥é©Ÿ**:

**Phase 1: è¨­è¨ˆæ¨¡çµ„æ¶æ§‹**ï¼ˆ30minï¼‰
```typescript
// libs/common/src/modules/base-microservice.module.ts
export interface BaseMicroserviceOptions {
  includeAuth?: boolean;
  includeKafka?: boolean;
  includeRedis?: boolean;
  additionalImports?: any[];
}

@Module({})
export class BaseMicroserviceModule {
  static forRoot(options: BaseMicroserviceOptions = {}): DynamicModule {
    // å‹•æ…‹é…ç½®æ¨¡çµ„
  }
}
```

**Phase 2: å¯¦ç¾æ¨¡çµ„**ï¼ˆ1hï¼‰
1. âœ… å¯¦ç¾ `forRoot` æ–¹æ³•
2. âœ… è™•ç†æ¢ä»¶å°å…¥
3. âœ… ç·¨å¯«æ–‡æª”
4. âœ… å‰µå»ºä½¿ç”¨ç¯„ä¾‹

**Phase 3: é·ç§»æœå‹™**ï¼ˆ30minï¼‰
1. âœ… é·ç§» 3 å€‹è©¦é»æœå‹™ï¼š
   - `user-service`
   - `content-service`
   - `payment-service`
2. âœ… é©—è­‰åŠŸèƒ½æ­£å¸¸
3. âœ… æ€§èƒ½æ¸¬è©¦

**é©—æ”¶æ¨™æº–**:
- [ ] æ¨¡çµ„å¯é…ç½®
- [ ] 3 å€‹æœå‹™æˆåŠŸé·ç§»
- [ ] å•Ÿå‹•æ™‚é–“ç„¡æ˜é¡¯å¢åŠ 
- [ ] æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

**é¢¨éšª**: ä¸­ï¼ˆå½±éŸ¿æ‰€æœ‰æœå‹™å•Ÿå‹•ï¼‰  
**è² è²¬äºº**: Backend Lead  
**é ä¼°å·¥æ™‚**: 2 å°æ™‚

---

#### Day 3-4: äº‹ä»¶ç”Ÿç”¢è€…é‡æ§‹

**Task 2.2: å‰µå»ºåŸºç¤äº‹ä»¶ç”Ÿç”¢è€…**ï¼ˆ2hï¼‰

**æ­¥é©Ÿ**:

**Phase 1: è¨­è¨ˆåŸºç¤é¡**ï¼ˆ30minï¼‰
```typescript
// libs/kafka/src/base-event-producer.ts
@Injectable()
export abstract class BaseEventProducer implements OnModuleInit {
  protected abstract readonly logger: Logger;

  constructor(
    @Inject('KAFKA_SERVICE') protected readonly kafkaClient: ClientKafka,
  ) {}

  async onModuleInit() {
    await this.kafkaClient.connect();
    this.logger.log('Kafka producer connected');
  }

  protected async emit<T>(eventName: string, data: T): Promise<void> {
    try {
      await this.kafkaClient.emit(eventName, data).toPromise();
      this.logger.debug(`Event emitted: ${eventName}`);
    } catch (error) {
      this.logger.error(`Failed to emit event: ${eventName}`, error);
      throw error;
    }
  }
}
```

**Phase 2: é‡æ§‹ç”Ÿç”¢è€…**ï¼ˆ1hï¼‰
1. âœ… é‡æ§‹ `ContentProducer`
2. âœ… é‡æ§‹ `PaymentProducer`
3. âœ… é‡æ§‹ `SubscriptionProducer`
4. âœ… é©—è­‰äº‹ä»¶ç™¼é€

**Phase 3: æ¸¬è©¦**ï¼ˆ30minï¼‰
1. âœ… å–®å…ƒæ¸¬è©¦
2. âœ… é›†æˆæ¸¬è©¦
3. âœ… ç«¯åˆ°ç«¯æ¸¬è©¦ï¼ˆç™¼é€-æ¥æ”¶ï¼‰

**é©—æ”¶æ¨™æº–**:
- [ ] 3 å€‹ç”Ÿç”¢è€…æˆåŠŸé‡æ§‹
- [ ] äº‹ä»¶ç™¼é€æ­£å¸¸
- [ ] æ¸¬è©¦è¦†è“‹ç‡ 80%+
- [ ] ç„¡äº‹ä»¶ä¸Ÿå¤±

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Dev #2  
**é ä¼°å·¥æ™‚**: 2 å°æ™‚

---

#### Day 5: Redis éµç®¡ç†æ¨™æº–åŒ–

**Task 2.3: å‰µå»º Redis éµå¸¸æ•¸**ï¼ˆ2hï¼‰

**æ­¥é©Ÿ**:

**Phase 1: è¨­è¨ˆéµçµæ§‹**ï¼ˆ30minï¼‰
```typescript
// libs/common/src/constants/redis-keys.ts
export class RedisKeys {
  // User
  static user(userId: string): string {
    return `user:${userId}`;
  }
  
  // Post
  static post(postId: string): string {
    return `post:${postId}`;
  }
  
  // TTL
  static readonly TTL = {
    SHORT: 60,
    MEDIUM: 300,
    LONG: 3600,
  };
}
```

**Phase 2: é·ç§»æœå‹™**ï¼ˆ1hï¼‰
1. âœ… æ›´æ–° `post.service.ts`
2. âœ… æ›´æ–° `feed.service.ts`
3. âœ… æ›´æ–° `user.service.ts`
4. âœ… æ›´æ–° `wallet.service.ts`
5. âœ… æ›´æ–° `subscription.service.ts`

**Phase 3: é©—è­‰**ï¼ˆ30minï¼‰
1. âœ… é©—è­‰éµåæ­£ç¢º
2. âœ… é©—è­‰ TTL è¨­ç½®
3. âœ… æª¢æŸ¥éµè¡çª

**é©—æ”¶æ¨™æº–**:
- [ ] æ‰€æœ‰éµçµ±ä¸€å‘½å
- [ ] 6 å€‹æœå‹™æˆåŠŸé·ç§»
- [ ] ç„¡éµåè¡çª
- [ ] Redis åŠŸèƒ½æ­£å¸¸

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Dev #1  
**é ä¼°å·¥æ™‚**: 2 å°æ™‚

---

### Week 3: éŒ¯èª¤è™•ç†å’Œé©—è­‰æ¨™æº–åŒ–

#### Day 1-3: éŒ¯èª¤è™•ç†é‡æ§‹

**Task 3.1: å‰µå»ºé©—è­‰æœå‹™**ï¼ˆ3hï¼‰

**æ­¥é©Ÿ**:

**Phase 1: è¨­è¨ˆé©—è­‰ API**ï¼ˆ1hï¼‰
```typescript
// libs/common/src/utils/validation.service.ts
export class ValidationService {
  static throwIfNotFound<T>(
    entity: T | null | undefined,
    entityName: string,
    identifier?: string
  ): asserts entity is T {
    if (!entity) {
      throw new NotFoundException(`${entityName} not found: ${identifier}`);
    }
  }

  static throwIfNotOwner(
    resourceOwnerId: string,
    currentUserId: string,
    resourceName = 'resource'
  ): void {
    if (resourceOwnerId !== currentUserId) {
      throw new ForbiddenException(`You do not own this ${resourceName}`);
    }
  }

  // ... æ›´å¤šé©—è­‰æ–¹æ³•
}
```

**Phase 2: é‡æ§‹æœå‹™**ï¼ˆ1.5hï¼‰
1. âœ… é‡æ§‹ `user.service.ts`ï¼ˆ17 è™•ç•°å¸¸ï¼‰
2. âœ… é‡æ§‹ `post.service.ts`ï¼ˆ12 è™•ç•°å¸¸ï¼‰
3. âœ… é‡æ§‹ `wallet.service.ts`ï¼ˆå¤šè™•ç•°å¸¸ï¼‰
4. âœ… é‡æ§‹å…¶ä»–æœå‹™

**Phase 3: æ¸¬è©¦**ï¼ˆ30minï¼‰
1. âœ… å–®å…ƒæ¸¬è©¦
2. âœ… é©—è­‰éŒ¯èª¤è¨Šæ¯çµ±ä¸€
3. âœ… é©—è­‰é¡å‹æ¨å°æ­£ç¢º

**é©—æ”¶æ¨™æº–**:
- [ ] é©—è­‰æœå‹™æ¸¬è©¦è¦†è“‹ç‡ 100%
- [ ] ä¸»è¦æœå‹™å·²é·ç§»
- [ ] éŒ¯èª¤è¨Šæ¯çµ±ä¸€
- [ ] TypeScript é¡å‹æ¨å°æ­£ç¢º

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Dev #2  
**é ä¼°å·¥æ™‚**: 3 å°æ™‚

---

#### Day 4-5: å®Œæˆå‰©é¤˜æœå‹™é·ç§»

**Task 3.2: å…¨é¢æ¨å»£é‡æ§‹**ï¼ˆ2 å¤©ï¼‰

**æ­¥é©Ÿ**:

**Day 4 ä¸Šåˆ**: å®Œæˆ P0 é …ç›®å‰©é¤˜é·ç§»
1. âœ… æ—¥èªŒè£é£¾å™¨æ¨å»£è‡³æ‰€æœ‰æœå‹™
2. âœ… ID ç”Ÿæˆå™¨æ¨å»£è‡³æ‰€æœ‰éœ€è¦è™•
3. âœ… æœå‹™å®¢æˆ¶ç«¯å®Œæ•´é›†æˆ

**Day 4 ä¸‹åˆ**: å®Œæˆ P1 é …ç›®å‰©é¤˜é·ç§»
1. âœ… åŸºç¤æ¨¡çµ„æ¨å»£è‡³æ‰€æœ‰å¾®æœå‹™
2. âœ… Redis éµæ¨™æº–åŒ–å®Œæˆ
3. âœ… éŒ¯èª¤è™•ç†æ¨™æº–åŒ–å®Œæˆ

**Day 5**: æ¸¬è©¦å’Œé©—è­‰
1. âœ… å…¨é¢é›†æˆæ¸¬è©¦
2. âœ… æ€§èƒ½æ¸¬è©¦
3. âœ… å®‰å…¨æ¸¬è©¦
4. âœ… å›æ­¸æ¸¬è©¦

**é©—æ”¶æ¨™æº–**:
- [ ] æ‰€æœ‰æœå‹™æˆåŠŸé·ç§»
- [ ] æ‰€æœ‰æ¸¬è©¦é€šé
- [ ] ç„¡æ€§èƒ½å›æ­¸
- [ ] ç„¡åŠŸèƒ½å›æ­¸

**é¢¨éšª**: ä¸­ï¼ˆå¤§è¦æ¨¡è®Šæ›´ï¼‰  
**è² è²¬äºº**: å…¨é«”å¾Œç«¯åœ˜éšŠ  
**é ä¼°å·¥æ™‚**: 2 å¤©

---

### Week 4: DTO çµ±ä¸€å’Œæœ€çµ‚å„ªåŒ–

#### Day 1-2: DTO çµ±ä¸€

**Task 4.1: æª¢æŸ¥å’Œåˆä½µ DTO**ï¼ˆ2 å¤©ï¼‰

**æ­¥é©Ÿ**:

**Phase 1: DTO å¯©è¨ˆ**ï¼ˆ4hï¼‰
1. âœ… åˆ—å‡ºæ‰€æœ‰ DTO å®šç¾©
   - `apps/payment-service/src/app/dto/`
   - `apps/subscription-service/src/app/dto/`
   - `apps/content-service/src/app/dto/`
   - `libs/dto/`
2. âœ… è­˜åˆ¥é‡è¤‡å’Œè¡çª
3. âœ… åˆ¶å®šåˆä½µè¨ˆåŠƒ

**Phase 2: DTO åˆä½µ**ï¼ˆ4hï¼‰
1. âœ… å°‡é€šç”¨ DTO ç§»è‡³ `libs/dto/`
2. âœ… ä¿ç•™æœå‹™ç‰¹å®š DTO
3. âœ… æ›´æ–°æ‰€æœ‰å°å…¥
4. âœ… é©—è­‰é©—è­‰è¦å‰‡ä¸€è‡´

**é©—æ”¶æ¨™æº–**:
- [ ] DTO ç„¡é‡è¤‡å®šç¾©
- [ ] é©—è­‰è¦å‰‡çµ±ä¸€
- [ ] æ‰€æœ‰å°å…¥æ­£ç¢º
- [ ] API é©—è­‰æ­£å¸¸

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Dev #1  
**é ä¼°å·¥æ™‚**: 8 å°æ™‚ï¼ˆ2 å¤©ï¼‰

---

#### Day 3-4: æ¸¬è©¦è¦†è“‹ç‡æå‡

**Task 4.2: å®Œå–„æ¸¬è©¦**ï¼ˆ2 å¤©ï¼‰

**æ­¥é©Ÿ**:

**Day 3**: å–®å…ƒæ¸¬è©¦
1. âœ… ç‚ºæ–°çš„å…±äº«åº«ç·¨å¯«æ¸¬è©¦
2. âœ… æå‡æ ¸å¿ƒæœå‹™æ¸¬è©¦è¦†è“‹ç‡
3. âœ… ç›®æ¨™: 80%+ è¦†è“‹ç‡

**Day 4**: é›†æˆæ¸¬è©¦
1. âœ… ç«¯åˆ°ç«¯æ¸¬è©¦
2. âœ… æœå‹™é–“é€šè¨Šæ¸¬è©¦
3. âœ… Kafka äº‹ä»¶æ¸¬è©¦

**é©—æ”¶æ¨™æº–**:
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ 80%+
- [ ] é›†æˆæ¸¬è©¦é€šé
- [ ] ç«¯åˆ°ç«¯æ¸¬è©¦é€šé

**é¢¨éšª**: ä½  
**è² è²¬äºº**: å…¨é«”å¾Œç«¯åœ˜éšŠ  
**é ä¼°å·¥æ™‚**: 2 å¤©

---

#### Day 5: æ–‡æª”å’Œéƒ¨ç½²

**Task 4.3: æ–‡æª”æ›´æ–°å’Œéƒ¨ç½²æº–å‚™**ï¼ˆ1 å¤©ï¼‰

**æ­¥é©Ÿ**:

**ä¸Šåˆ: æ–‡æª”æ›´æ–°**ï¼ˆ4hï¼‰
1. âœ… æ›´æ–°æ¶æ§‹æ–‡æª”
2. âœ… æ›´æ–°é–‹ç™¼æŒ‡å—
3. âœ… æ›´æ–°å…±äº«åº«æ–‡æª”
4. âœ… å‰µå»ºé‡æ§‹ç¸½çµå ±å‘Š

**ä¸‹åˆ: éƒ¨ç½²æº–å‚™**ï¼ˆ4hï¼‰
1. âœ… Code Review
2. âœ… æ€§èƒ½åŸºæº–æ¸¬è©¦
3. âœ… å‰µå»ºéƒ¨ç½²è¨ˆåŠƒ
4. âœ… æº–å‚™å›æ»¾æ–¹æ¡ˆ

**é©—æ”¶æ¨™æº–**:
- [ ] æ–‡æª”å®Œæ•´æ›´æ–°
- [ ] Code Review é€šé
- [ ] æº–å‚™å¥½éƒ¨ç½²
- [ ] å›æ»¾æ–¹æ¡ˆå°±ç·’

**é¢¨éšª**: ä½  
**è² è²¬äºº**: Backend Lead  
**é ä¼°å·¥æ™‚**: 1 å¤©

---

## ğŸ§ª æ¸¬è©¦ç­–ç•¥

### å–®å…ƒæ¸¬è©¦

**ç›®æ¨™**: 80%+ è¦†è“‹ç‡

**é‡é»æ¸¬è©¦**:
1. âœ… å…±äº«åº«ï¼ˆ100% è¦†è“‹ç‡ï¼‰
   - `IdGenerator`
   - `ValidationService`
   - `RedisKeys`
   - `BaseServiceClient`
   - `BaseEventProducer`

2. âœ… æ ¸å¿ƒæœå‹™é‚è¼¯ï¼ˆ80%+ è¦†è“‹ç‡ï¼‰
   - æ¥­å‹™é‚è¼¯
   - è³‡æ–™è½‰æ›
   - éŒ¯èª¤è™•ç†

**å·¥å…·**: Jest

```bash
# åŸ·è¡Œæ¸¬è©¦
npm run test

# æ¸¬è©¦è¦†è“‹ç‡
npm run test:cov

# ç›£è¦–æ¨¡å¼
npm run test:watch
```

### é›†æˆæ¸¬è©¦

**ç›®æ¨™**: è¦†è“‹é—œéµæµç¨‹

**é‡é»æ¸¬è©¦**:
1. âœ… æœå‹™é–“é€šè¨Š
   - HTTP èª¿ç”¨
   - Kafka äº‹ä»¶
2. âœ… è³‡æ–™åº«æ“ä½œ
3. âœ… Redis å¿«å–

**å·¥å…·**: Jest + Supertest

```bash
npm run test:integration
```

### ç«¯åˆ°ç«¯æ¸¬è©¦

**ç›®æ¨™**: è¦†è“‹ä¸»è¦æ¥­å‹™æµç¨‹

**æ¸¬è©¦å ´æ™¯**:
1. âœ… ç”¨æˆ¶è¨»å†Š â†’ ç™»å…¥ â†’ å»ºç«‹è²¼æ–‡
2. âœ… ç”¨æˆ¶è¨‚é–± â†’ ç™¼é€è¨Šæ¯
3. âœ… ç”¨æˆ¶æ‰“è³ â†’ éŒ¢åŒ…æ›´æ–°

**å·¥å…·**: Playwright

```bash
npm run test:e2e
```

### æ€§èƒ½æ¸¬è©¦

**ç›®æ¨™**: ç„¡æ€§èƒ½å›æ­¸

**æ¸¬è©¦æŒ‡æ¨™**:
1. âœ… API éŸ¿æ‡‰æ™‚é–“
2. âœ… è³‡æ–™åº«æŸ¥è©¢æ™‚é–“
3. âœ… Redis æ“ä½œæ™‚é–“
4. âœ… è¨˜æ†¶é«”ä½¿ç”¨

**å·¥å…·**: Artillery, k6

```bash
npm run test:performance
```

---

## ğŸ” Code Review æª¢æŸ¥æ¸…å–®

### é‡æ§‹ Code Review è¦é»

**é€šç”¨æª¢æŸ¥**:
- [ ] ä»£ç¢¼ç¬¦åˆ TypeScript æœ€ä½³å¯¦è¸
- [ ] æ²’æœ‰å¼•å…¥æ–°çš„æŠ€è¡“å‚µå‹™
- [ ] æ¸¬è©¦è¦†è“‹ç‡é”æ¨™
- [ ] æ–‡æª”å·²æ›´æ–°
- [ ] æ€§èƒ½ç„¡å›æ­¸

**å…±äº«åº«æª¢æŸ¥**:
- [ ] API è¨­è¨ˆåˆç†
- [ ] é¡å‹å®šç¾©å®Œæ•´
- [ ] éŒ¯èª¤è™•ç†å®Œå–„
- [ ] æ–‡æª”æ¸…æ™°
- [ ] æ¸¬è©¦å……åˆ†

**æœå‹™é·ç§»æª¢æŸ¥**:
- [ ] å°å…¥è·¯å¾‘æ­£ç¢º
- [ ] åŠŸèƒ½ç­‰æ•ˆ
- [ ] ç„¡ç ´å£æ€§è®Šæ›´
- [ ] æ—¥èªŒå®Œæ•´
- [ ] éŒ¯èª¤è™•ç†ä¸€è‡´

---

## ğŸš¨ é¢¨éšªç®¡ç†

### è­˜åˆ¥çš„é¢¨éšª

| é¢¨éšª | ç­‰ç´š | å½±éŸ¿ | ç·©è§£ç­–ç•¥ |
|------|------|------|----------|
| å¤§è¦æ¨¡ä»£ç¢¼è®Šæ›´ | ğŸŸ¡ ä¸­ | å¼•å…¥ Bug | å……åˆ†æ¸¬è©¦ã€æ¼¸é€²å¼é·ç§» |
| æœå‹™é–“é€šè¨Šè®Šæ›´ | ğŸŸ¡ ä¸­ | æœå‹™ä¸å¯ç”¨ | ä¿æŒå‘å¾Œå…¼å®¹ã€ç›£æ§ |
| æ€§èƒ½ä¸‹é™ | ğŸŸ¢ ä½ | ç”¨æˆ¶é«”é©— | æ€§èƒ½åŸºæº–æ¸¬è©¦ |
| åœ˜éšŠå­¸ç¿’æ›²ç·š | ğŸŸ¢ ä½ | é–‹ç™¼æ•ˆç‡ | æ–‡æª”ã€åŸ¹è¨“ |

### ç·©è§£æªæ–½

**1. æ¼¸é€²å¼é·ç§»**
- å…ˆé·ç§»éé—œéµæœå‹™
- æ¯æ¬¡åªè®Šæ›´ä¸€å€‹æœå‹™
- å……åˆ†æ¸¬è©¦å¾Œå†ç¹¼çºŒ

**2. åŠŸèƒ½é–‹é—œ**
```typescript
// å¯åˆ‡æ›å›èˆŠå¯¦ç¾
const USE_NEW_LOGGER = process.env.USE_NEW_LOGGER === 'true';

if (USE_NEW_LOGGER) {
  // ä½¿ç”¨æ–°çš„æ—¥èªŒè£é£¾å™¨
} else {
  // ä½¿ç”¨èˆŠçš„æ—¥èªŒåˆå§‹åŒ–
}
```

**3. ç›£æ§å’Œå‘Šè­¦**
- éƒ¨ç½²å¾Œå¯†åˆ‡ç›£æ§
- è¨­ç½®éŒ¯èª¤ç‡å‘Šè­¦
- æº–å‚™å¿«é€Ÿå›æ»¾

**4. å›æ»¾è¨ˆåŠƒ**
```bash
# å›æ»¾åˆ°ä¸Šä¸€å€‹ç‰ˆæœ¬
git revert <commit>
kubectl rollout undo deployment/<service-name>
```

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ¨™

### ä»£ç¢¼è³ªé‡æŒ‡æ¨™

| æŒ‡æ¨™ | åŸºæº– | ç›®æ¨™ | æ¸¬é‡æ–¹å¼ |
|------|------|------|----------|
| é‡è¤‡ä»£ç¢¼è¡Œæ•¸ | 506+ | <100 | SonarQube |
| ä»£ç¢¼è¦†è“‹ç‡ | æœªçŸ¥ | 80%+ | Jest |
| æŠ€è¡“å‚µå‹™æ™‚é–“ | æœªçŸ¥ | -50% | SonarQube |
| ä»£ç¢¼ç•°å‘³ | æœªçŸ¥ | -70% | SonarQube |

### é–‹ç™¼æ•ˆç‡æŒ‡æ¨™

| æŒ‡æ¨™ | åŸºæº– | ç›®æ¨™ | æ¸¬é‡æ–¹å¼ |
|------|------|------|----------|
| æ–°æœå‹™å‰µå»ºæ™‚é–“ | 4h | 1h | è¨˜éŒ„ |
| Bug ä¿®å¾©æ™‚é–“ | 2h | 0.5h | JIRA |
| Code Review æ™‚é–“ | 1h | 0.5h | GitHub |
| éƒ¨ç½²é »ç‡ | 1æ¬¡/é€± | 3æ¬¡/é€± | CI/CD |

### é‹è¡Œæ™‚æŒ‡æ¨™

| æŒ‡æ¨™ | åŸºæº– | ç›®æ¨™ | æ¸¬é‡æ–¹å¼ |
|------|------|------|----------|
| API éŸ¿æ‡‰æ™‚é–“ | 100ms | <150ms | Prometheus |
| éŒ¯èª¤ç‡ | 0.1% | <0.2% | Sentry |
| æœå‹™å¯ç”¨æ€§ | 99.9% | >99.9% | Uptime |
| è¨˜æ†¶é«”ä½¿ç”¨ | 500MB | <600MB | Kubernetes |

---

## ğŸ“š æ–‡æª”æ›´æ–°æ¸…å–®

### éœ€è¦æ›´æ–°çš„æ–‡æª”

**æ¶æ§‹æ–‡æª”**:
- [ ] ç³»çµ±æ¶æ§‹åœ–
- [ ] å¾®æœå‹™é€šè¨Šåœ–
- [ ] æ•¸æ“šæµåœ–
- [ ] éƒ¨ç½²æ¶æ§‹åœ–

**é–‹ç™¼æ–‡æª”**:
- [ ] é–‹ç™¼ç’°å¢ƒè¨­ç½®
- [ ] ä»£ç¢¼è¦ç¯„
- [ ] å…±äº«åº«ä½¿ç”¨æŒ‡å—
- [ ] API æ–‡æª”

**é‹ç¶­æ–‡æª”**:
- [ ] éƒ¨ç½²æŒ‡å—
- [ ] ç›£æ§å’Œå‘Šè­¦
- [ ] æ•…éšœæ’æŸ¥
- [ ] å›æ»¾æµç¨‹

**åŸ¹è¨“ææ–™**:
- [ ] é‡æ§‹æ¦‚è¿°ç°¡å ±
- [ ] å…±äº«åº«æ•™ç¨‹
- [ ] æœ€ä½³å¯¦è¸æŒ‡å—
- [ ] FAQ

---

## ğŸ‘¥ åœ˜éšŠåˆ†å·¥

### è§’è‰²å’Œè·è²¬

**Backend Lead**ï¼ˆå…¨ç¨‹ï¼‰
- æ•´é«”æ¶æ§‹è¨­è¨ˆ
- Code Review
- é¢¨éšªç®¡ç†
- é€²åº¦è¿½è¹¤

**Backend Dev #1**ï¼ˆWeek 1-2ï¼‰
- æ—¥èªŒè£é£¾å™¨
- Redis éµç®¡ç†
- æœå‹™å®¢æˆ¶ç«¯ï¼ˆå”ä½œï¼‰
- DTO çµ±ä¸€

**Backend Dev #2**ï¼ˆWeek 1-2ï¼‰
- ID ç”Ÿæˆå™¨
- äº‹ä»¶ç”Ÿç”¢è€…
- éŒ¯èª¤è™•ç†
- æœå‹™å®¢æˆ¶ç«¯ï¼ˆå”ä½œï¼‰

**QA Engineer**ï¼ˆWeek 3-4ï¼‰
- æ¸¬è©¦è¨ˆåŠƒ
- åŸ·è¡Œæ¸¬è©¦
- Bug è¿½è¹¤
- æ¸¬è©¦å ±å‘Š

**å…¨é«”åœ˜éšŠ**ï¼ˆWeek 3-4ï¼‰
- å…¨é¢é·ç§»
- æ¸¬è©¦
- æ–‡æª”
- éƒ¨ç½²æº–å‚™

---

## ğŸ“… æ¯é€±æª¢æŸ¥é»

### Week 1 æª¢æŸ¥é»ï¼ˆé€±äº”ï¼‰

**ç›®æ¨™**: P0 é …ç›®å®Œæˆ 90%

**æª¢æŸ¥é …ç›®**:
- [ ] æ—¥èªŒè£é£¾å™¨å®Œæˆä¸¦æ¸¬è©¦
- [ ] ID ç”Ÿæˆå™¨å®Œæˆä¸¦æ¸¬è©¦
- [ ] æœå‹™å®¢æˆ¶ç«¯åŸºç¤é¡å®Œæˆ
- [ ] 5 å€‹è©¦é»æœå‹™å·²é·ç§»
- [ ] å–®å…ƒæ¸¬è©¦é€šé

**Go/No-Go æ±ºç­–**:
- âœ… ç¹¼çºŒ: 90%+ å®Œæˆåº¦ï¼Œæ¸¬è©¦é€šé
- âš ï¸ èª¿æ•´: 70-90% å®Œæˆåº¦ï¼Œéœ€è¦èª¿æ•´è¨ˆåŠƒ
- ğŸ›‘ æš«åœ: <70% å®Œæˆåº¦ï¼Œéœ€è¦é‡æ–°è©•ä¼°

---

### Week 2 æª¢æŸ¥é»ï¼ˆé€±äº”ï¼‰

**ç›®æ¨™**: P1 é …ç›®å®Œæˆ 90%

**æª¢æŸ¥é …ç›®**:
- [ ] åŸºç¤æ¨¡çµ„å®Œæˆ
- [ ] äº‹ä»¶ç”Ÿç”¢è€…é‡æ§‹å®Œæˆ
- [ ] Redis éµæ¨™æº–åŒ–å®Œæˆ
- [ ] æ‰€æœ‰è©¦é»æœå‹™å·²é·ç§»
- [ ] é›†æˆæ¸¬è©¦é€šé

**Go/No-Go æ±ºç­–**:
- âœ… ç¹¼çºŒ: 90%+ å®Œæˆåº¦ï¼Œæ¸¬è©¦é€šé
- âš ï¸ èª¿æ•´: 70-90% å®Œæˆåº¦ï¼Œéœ€è¦èª¿æ•´è¨ˆåŠƒ
- ğŸ›‘ æš«åœ: <70% å®Œæˆåº¦ï¼Œéœ€è¦é‡æ–°è©•ä¼°

---

### Week 3 æª¢æŸ¥é»ï¼ˆé€±äº”ï¼‰

**ç›®æ¨™**: æ‰€æœ‰æœå‹™é·ç§»å®Œæˆ

**æª¢æŸ¥é …ç›®**:
- [ ] éŒ¯èª¤è™•ç†æ¨™æº–åŒ–å®Œæˆ
- [ ] æ‰€æœ‰æœå‹™å·²é·ç§»
- [ ] å…¨é¢æ¸¬è©¦é€šé
- [ ] æ€§èƒ½ç„¡å›æ­¸
- [ ] æº–å‚™é€²å…¥æœ€å¾Œéšæ®µ

**Go/No-Go æ±ºç­–**:
- âœ… ç¹¼çºŒ: 95%+ å®Œæˆåº¦ï¼Œæ‰€æœ‰æ¸¬è©¦é€šé
- âš ï¸ å»¶æœŸ: éœ€è¦é¡å¤–æ™‚é–“å®Œæˆé·ç§»
- ğŸ›‘ æš«åœ: åš´é‡å•é¡Œï¼Œéœ€è¦é‡æ–°è©•ä¼°

---

### Week 4 æª¢æŸ¥é»ï¼ˆé€±äº”ï¼‰

**ç›®æ¨™**: é‡æ§‹å®Œæˆï¼Œæº–å‚™éƒ¨ç½²

**æª¢æŸ¥é …ç›®**:
- [ ] DTO çµ±ä¸€å®Œæˆ
- [ ] æ¸¬è©¦è¦†è“‹ç‡é”æ¨™
- [ ] æ–‡æª”å®Œæ•´æ›´æ–°
- [ ] Code Review é€šé
- [ ] éƒ¨ç½²è¨ˆåŠƒå°±ç·’

**Go/No-Go æ±ºç­–**:
- âœ… éƒ¨ç½²: 100% å®Œæˆï¼Œæ‰€æœ‰æª¢æŸ¥é€šé
- âš ï¸ å»¶æœŸ: éœ€è¦é¡å¤–æ¸¬è©¦æˆ–ä¿®å¾©
- ğŸ›‘ å–æ¶ˆ: åš´é‡å•é¡Œï¼Œéœ€è¦å›æ»¾

---

## ğŸ¯ æœ€çµ‚é©—æ”¶æ¨™æº–

### å¿…é ˆé”æˆï¼ˆP0ï¼‰

- [ ] **ä»£ç¢¼é‡è¤‡æ¸›å°‘ 80%+**
  - åŸºæº–: 506+ è¡Œ
  - ç›®æ¨™: <100 è¡Œ
  - æ¸¬é‡: SonarQube

- [ ] **æ¸¬è©¦è¦†è“‹ç‡ 80%+**
  - å–®å…ƒæ¸¬è©¦
  - é›†æˆæ¸¬è©¦
  - ç«¯åˆ°ç«¯æ¸¬è©¦

- [ ] **æ‰€æœ‰æœå‹™æˆåŠŸé·ç§»**
  - 13 å€‹å¾®æœå‹™
  - åŠŸèƒ½ç­‰æ•ˆ
  - ç„¡å›æ­¸

- [ ] **æ€§èƒ½ç„¡æ˜é¡¯ä¸‹é™**
  - API éŸ¿æ‡‰æ™‚é–“ < +50%
  - è¨˜æ†¶é«”ä½¿ç”¨ < +20%
  - éŒ¯èª¤ç‡ < 0.2%

### æœŸæœ›é”æˆï¼ˆP1ï¼‰

- [ ] **æ–‡æª”å®Œæ•´æ›´æ–°**
  - æ¶æ§‹æ–‡æª”
  - é–‹ç™¼æŒ‡å—
  - API æ–‡æª”

- [ ] **åœ˜éšŠåŸ¹è¨“å®Œæˆ**
  - å…±äº«åº«ä½¿ç”¨
  - æœ€ä½³å¯¦è¸
  - FAQ

- [ ] **ç›£æ§å’Œå‘Šè­¦å°±ç·’**
  - æ€§èƒ½ç›£æ§
  - éŒ¯èª¤è¿½è¹¤
  - å‘Šè­¦é…ç½®

### å¯é¸é”æˆï¼ˆP2ï¼‰

- [ ] **æ€§èƒ½å„ªåŒ–**
  - éŸ¿æ‡‰æ™‚é–“æ¸›å°‘ 20%
  - è¨˜æ†¶é«”ä½¿ç”¨æ¸›å°‘ 10%

- [ ] **è‡ªå‹•åŒ–æ”¹é€²**
  - CI/CD å„ªåŒ–
  - è‡ªå‹•åŒ–æ¸¬è©¦æ“´å±•

---

## ğŸ“ è®Šæ›´æ—¥èªŒ

| æ—¥æœŸ | ç‰ˆæœ¬ | è®Šæ›´å…§å®¹ | è² è²¬äºº |
|------|------|----------|--------|
| 2024-02-17 | 1.0.0 | åˆå§‹é‡æ§‹è¨ˆåŠƒ | Backend Team |
| - | - | - | - |

---

## ğŸ“ è¯ç¹«è³‡è¨Š

**é …ç›®è² è²¬äºº**: Backend Lead  
**æŠ€è¡“è«®è©¢**: Backend Team  
**å•é¡Œå ±å‘Š**: [GitHub Issues](https://github.com/your-repo/issues)  
**é€²åº¦è¿½è¹¤**: [JIRA Board](https://your-jira.atlassian.net)

---

**æœ€å¾Œæ›´æ–°**: 2024-02-17  
**ç‰ˆæœ¬**: 1.0.0  
**ç‹€æ…‹**: âœ… å·²æ‰¹å‡†ï¼Œæº–å‚™åŸ·è¡Œ

---

## é™„éŒ„

### A. å…±äº«åº«æ¸…å–®

**å·²å‰µå»º**:
- `@suggar-daddy/common`
- `@suggar-daddy/kafka`
- `@suggar-daddy/redis`
- `@suggar-daddy/auth`
- `@suggar-daddy/env`

**å¾…å‰µå»º**:
- `@suggar-daddy/service-clients`
- `@suggar-daddy/dto`ï¼ˆå¾…æ•´åˆï¼‰

### B. å·¥å…·å’Œè…³æœ¬

**ä»£ç¢¼è³ªé‡æª¢æŸ¥**:
```bash
# SonarQube æƒæ
npm run sonar

# é‡è¤‡ä»£ç¢¼æª¢æ¸¬
npm run cpd

# Linting
npm run lint
```

**æ¸¬è©¦**:
```bash
# å–®å…ƒæ¸¬è©¦
npm run test

# é›†æˆæ¸¬è©¦
npm run test:integration

# E2E æ¸¬è©¦
npm run test:e2e

# è¦†è“‹ç‡
npm run test:cov
```

**éƒ¨ç½²**:
```bash
# æ§‹å»ºæ‰€æœ‰æœå‹™
npm run build:all

# éƒ¨ç½²åˆ° staging
npm run deploy:staging

# éƒ¨ç½²åˆ° production
npm run deploy:production
```

### C. åƒè€ƒè³‡æ–™

**å…§éƒ¨æ–‡æª”**:
- [ä»£ç¢¼é‡è¤‡åˆ†æå ±å‘Š](./code-duplication.md)
- [API å®Œæ•´æ€§æª¢æŸ¥](./api-completeness.md)
- [ç³»çµ±æ¶æ§‹æ–‡æª”](../architecture/system-architecture.md)

**å¤–éƒ¨è³‡æº**:
- [NestJS Best Practices](https://docs.nestjs.com)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [Clean Code](https://github.com/ryanmcdermott/clean-code-javascript)
