# 這個檔案包含需要添加到各服務的 secrets 配置
# 手動合併到 docker-compose.yml 或使用 docker-compose.override.yml

# PostgreSQL Master - 添加 secrets
services:
  postgres-master:
    secrets:
      - db_password
      - replication_password
    environment:
      POSTGRES_PASSWORD_FILE: /run/secrets/db_password
      REPLICATION_PASSWORD_FILE: /run/secrets/replication_password

  # PostgreSQL Replica - 添加 secrets
  postgres-replica:
    secrets:
      - db_password
      - replication_password
    environment:
      POSTGRES_PASSWORD_FILE: /run/secrets/db_password
      REPLICATION_PASSWORD_FILE: /run/secrets/replication_password

  # Auth Service - 添加 secrets
  auth-service:
    secrets:
      - db_password
      - jwt_secret
      - smtp_password
      - firebase_private_key
    environment:
      POSTGRES_PASSWORD_FILE: /run/secrets/db_password
      JWT_SECRET_FILE: /run/secrets/jwt_secret
      SMTP_PASSWORD_FILE: /run/secrets/smtp_password
      FIREBASE_PRIVATE_KEY_FILE: /run/secrets/firebase_private_key

  # User Service - 添加 secrets
  user-service:
    secrets:
      - db_password
      - cloudinary_cloud_name
      - cloudinary_api_key
      - cloudinary_api_secret
    environment:
      POSTGRES_PASSWORD_FILE: /run/secrets/db_password
      CLOUDINARY_CLOUD_NAME_FILE: /run/secrets/cloudinary_cloud_name
      CLOUDINARY_API_KEY_FILE: /run/secrets/cloudinary_api_key
      CLOUDINARY_API_SECRET_FILE: /run/secrets/cloudinary_api_secret

  # Payment Service - 添加 secrets
  payment-service:
    secrets:
      - db_password
      - stripe_secret_key
      - stripe_webhook_secret
      - stripe_publishable_key
    environment:
      POSTGRES_PASSWORD_FILE: /run/secrets/db_password
      STRIPE_SECRET_KEY_FILE: /run/secrets/stripe_secret_key
      STRIPE_WEBHOOK_SECRET_FILE: /run/secrets/stripe_webhook_secret
      STRIPE_PUBLISHABLE_KEY_FILE: /run/secrets/stripe_publishable_key

  # Subscription Service - 添加 secrets
  subscription-service:
    secrets:
      - db_password

  # DB Writer Service - 添加 secrets
  db-writer-service:
    secrets:
      - db_password

  # Matching Service - 添加 secrets
  matching-service:
    secrets:
      - db_password

  # Notification Service - 添加 secrets
  notification-service:
    secrets:
      - db_password

  # Messaging Service - 添加 secrets
  messaging-service:
    secrets:
      - db_password

  # Admin Service - 添加 secrets
  admin-service:
    secrets:
      - db_password

  # Content Service - 添加 secrets
  content-service:
    secrets:
      - db_password

  # Media Service - 添加 secrets
  media-service:
    secrets:
      - db_password
      - cloudinary_cloud_name
      - cloudinary_api_key
      - cloudinary_api_secret
